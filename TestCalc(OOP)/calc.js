const windowObject = {
    one: {
        default: {
            "800": {
                "1000": 2194,
                "1100": 2424,
                "1200": 2424,
                "1300": 2654,
                "1400": 2884,
                "1500": 3113
            },
            "900": {
                "1000": 2414,
                "1100": 2666,
                "1200": 2666,
                "1300": 2918,
                "1400": 3170,
                "1500": 3422
            },
            "1000": {
                "1000": 2636,
                "1100": 2910,
                "1200": 2910,
                "1300": 3184,
                "1400": 3458,
                "1500": 3732
            },
            "1100": {
                "1000": 2857,
                "1100": 3153,
                "1200": 3153,
                "1300": 3449,
                "1400": 3745,
                "1500": 4041
            },
            "1200": {
                "1000": 3078,
                "1100": 3096,
                "1200": 3096,
                "1300": 3714,
                "1400": 4062,
                "1500": 4350
            }

        },
        turn: {
            "800": {
                "1000": 4196,
                "1100": 4488,
                "1200": 4488,
                "1300": 4780,
                "1400": 5072,
                "1500": 5364
            },
            "900": {
                "1000": 4650,
                "1100": 4964,
                "1200": 4964,
                "1300": 5278,
                "1400": 5592,
                "1500": 5906
            },
            "1000": {
                "1000": 4914,
                "1100": 5250,
                "1200": 5250,
                "1300": 5586,
                "1400": 5922,
                "1500": 6258
            },
            "1100": {
                "1000": 5179,
                "1100": 5537,
                "1200": 5537,
                "1300": 5895,
                "1400": 6253,
                "1500": 6611
            },
            "1200": {
                "1000": 5442,
                "1100": 5822,
                "1200": 5822,
                "1300": 6202,
                "1400": 6582,
                "1500": 6962

            }
        }
    },
    two: {
        1: {
            "1100": {
                "1100": 3498,
                "1200": 3757,
                "1300": 4016,
                "1400": 4275,
                "1500": 4534,
                "1600": 4793
            },
            "1200": {
                "1100": 3737,
                "1200": 4014,
                "1300": 4291,
                "1400": 4568,
                "1500": 4845,
                "1600": 5122
            },
            "1300": {
                "1100": 3974,
                "1200": 4269,
                "1300": 4564,
                "1400": 4859,
                "1500": 5154,
                "1600": 5447
            },
            "1400": {
                "1100": 4212,
                "1200": 4524,
                "1300": 4836,
                "1400": 5148,
                "1500": 5460,
                "1600": 5771
            },
            "1500": {
                "1100": 4450,
                "1200": 4779,
                "1300": 5108,
                "1400": 5437,
                "1500": 5766,
                "1600": 6096
            },
            "1600": {
                "1100": 4688,
                "1200": 5035,
                "1300": 5382,
                "1400": 5729,
                "1500": 6067,
                "1600": 6422
            }
        },
        2: {
            "1100": {
                "1100": 5196,
                "1200": 5531,
                "1300": 5866,
                "1400": 6201,
                "1500": 6536,
                "1600": 6872
            },
            "1200": {
                "1100": 5463,
                "1200": 5814,
                "1300": 6165,
                "1400": 6516,
                "1500": 6867,
                "1600": 7220
            },
            "1300": {
                "1100": 5713,
                "1200": 6034,
                "1300": 6355,
                "1400": 6676,
                "1500": 6997,
                "1600": 7318
            },
            "1400": {
                "1100": 5914,
                "1200": 6314,
                "1300": 6714,
                "1400": 7114,
                "1500": 7514,
                "1600": 7912
            },
            "1500": {
                "1100": 6459,
                "1200": 6854,
                "1300": 7249,
                "1400": 7644,
                "1500": 8039,
                "1600": 8435
            },
            "1600": {
                "1100": 6906,
                "1200": 7319,
                "1300": 7732,
                "1400": 8145,
                "1500": 8558,
                "1600": 8971
            }
        },
        3: {
            "1100": {
                "1100": 7355,
                "1200": 7755,
                "1300": 8155,
                "1400": 8555,
                "1500": 8955,
                "1600": 9355
            },
            "1200": {
                "1100": 7654,
                "1200": 8068,
                "1300": 8482,
                "1400": 8896,
                "1500": 9310,
                "1600": 9726
            },
            "1300": {
                "1100": 7951,
                "1200": 8379,
                "1300": 8807,
                "1400": 9235,
                "1500": 9663,
                "1600": 10093
            },
            "1400": {
                "1100": 8019,
                "1200": 8495,
                "1300": 8971,
                "1400": 9447,
                "1500": 9923,
                "1600": 10397
            },
            "1500": {
                "1100": 8692,
                "1200": 9163,
                "1300": 9634,
                "1400": 10105,
                "1500": 10576,
                "1600": 11047

            },
            "1600": {
                "1100": 9349,
                "1200": 9839,
                "1300": 10329,
                "1400": 10819,
                "1500": 11309,
                "1600": 11794
            }
        }
    },
    three: {
        default: {
            "1700": {
                "1500": 9265,
                "1600": 9789,
                "1700": 10313,
                "1800": 10836
            },
            "1800": {
                "1500": 9587,
                "1600": 10129,
                "1700": 10671,
                "1800": 11211
            },
            "1900": {
                "1500": 9907,
                "1600": 10467,
                "1700": 11027,
                "1800": 11588
            },
            "2000": {
                "1500": 10230,
                "1600": 10808,
                "1700": 11386,
                "1800": 11963
            },
            "2100": {
                "1500": 10510,
                "1600": 11104,
                "1700": 11698,
                "1800": 12291
            },
            "2200": {
                "1500": 10935,
                "1600": 11541,
                "1700": 12147,
                "1800": 12754
            }
        }
    },
    coeffs: {
        "1": {
            "1": 1,
            "2": 1.4
        },
        "1.4": {
            "1": 1,
            "2": 1.5
        },
        "1.5": {
            "1": 1,
            "2": 1.4
        }
    },
    data: {
        key: {
            windowCountKey: null,
            windowTypeKey: null,
            windowTypeKey1: "default",
            windowTypeKey2: null,
            windowTypeKey3: null,
            widthKey: null,
            heightKey: null
        },
        size: {
            inputWidth: null,
            inputHeight: null
        },
        brands: {
            kbe: null,
            rehau: null,
            montblanc: null,
            brand: null
        },
        type: {
            typeProfile: null,
            typeProfileValue: "1",
            notification: null
        },
        quantity: {
            oneWindow: null,
            twoWindows: null,
            threeWindows: null
        },
        sectionType: {
            oneTypeSelector: null,
            twoTypeFirst: null,
            twoTypeSecond: null,
            firstArrayOption: null,
            secondArrayOption: null,
            selectPowerFirst: 1,
            selectPowerSecond: 1,
            mostPowerSelect: 1
        },
        output: {
            result: 0,
            totalResult: 0,
            k: 0,
            b: null,
            totalCoeff: 0,
            outputValue: null,
            outputMoscowValue: null,
            checkWidth: 0,
            checkHeight: 0
        }
    },
    init() {
        this.data.size.inputWidth = document.getElementById('input-width')
        this.data.size.inputHeight = document.getElementById('input-height')
        this.data.brands.kbe = document.getElementById('kbe')
        this.data.brands.rehau = document.getElementById('rehau')
        this.data.brands.montblanc = document.getElementById('montblanc')
        this.data.brands.brand = document.querySelector('.brand')
        this.data.type.typeProfile = document.getElementById('type-of-profile')
        this.data.type.notification = document.getElementById('notification')
        this.data.quantity.oneWindow = document.getElementById('one')
        this.data.quantity.twoWindows = document.getElementById('two')
        this.data.quantity.threeWindows = document.getElementById('three')
        this.data.sectionType.oneTypeSelector = document.getElementById('one-type-selector')
        this.data.sectionType.twoTypeFirst = document.getElementById('two-type-first')
        this.data.sectionType.twoTypeSecond = document.getElementById('two-type-second')
        this.data.sectionType.firstArrayOption = this.data.sectionType.twoTypeFirst.querySelectorAll('option')
        this.data.sectionType.secondArrayOption = this.data.sectionType.twoTypeSecond.querySelectorAll('option')
        this.data.output.outputValue = document.getElementById('output')
        this.data.output.outputMoscowValue = document.getElementById('output-moscow')
    },
    totalCoeff() {
        this.data.output.b = this.coeffs[this.data.output.k][this.data.type.typeProfileValue];
        this.data.output.totalCoeff = this.data.output.b * this.data.output.k;
        return this.data.output.totalCoeff;

    },
    validPrice() {
        if (this.data.key.windowCountKey === 'one') {
            this.data.key.windowTypeKey = this.data.key.windowTypeKey1;
            this.data.output.checkWidth = Number(this.data.key.widthKey);
            this.data.output.checkHeight = Number(this.data.key.heightKey);
            if (this.data.output.checkWidth < 800) {
                this.data.size.inputWidth.value = '800';
                this.data.output.checkWidth = 800;
                this.data.key.widthKey = String(this.data.output.checkWidth);

            }
            if (this.data.output.checkWidth > 1200) {
                this.data.type.notification.style.color = "#f26c4f";

            }
            if (this.data.output.checkHeight < 1000) {
                this.data.size.inputHeight.value = '1000';
                this.data.output.checkHeight = 1000;
                this.data.key.heightKey = String(this.data.output.checkHeight);
            }
            if (this.data.output.checkHeight > 1500) {
                this.data.type.notification.style.color = "#f26c4f";
            }
        }

        if (this.data.key.windowCountKey === 'two') {
            this.data.sectionType.mostPowerSelect = Math.max(this.data.sectionType.selectPowerFirst,
                this.data.sectionType.selectPowerSecond);
            this.data.key.windowTypeKey = this.data.sectionType.mostPowerSelect;
            this.data.output.checkWidth = Number(this.data.key.widthKey);
            this.data.output.checkHeight = Number(this.data.key.heightKey);
            if (this.data.output.checkWidth < 1100) {
                this.data.size.inputWidth.value = '1100';
                this.data.output.checkWidth = 1100;
                this.data.key.widthKey = String(this.data.output.checkWidth);

            }
            if (this.data.output.checkWidth > 1600) {
                this.data.type.notification.style.color = "#f26c4f";

            }
            if (this.data.output.checkHeight < 1100) {
                this.data.size.inputHeight.value = '1100';
                this.data.output.checkHeight = 1100;
                this.data.key.heightKey = String(this.data.output.checkHeight);
            }
            if (this.data.output.checkHeight > 1600) {
                this.data.type.notification.style.color = "#f26c4f";
            }
        }
        if (this.data.key.windowCountKey === 'three') {
            this.data.key.windowTypeKey = "default";
            this.data.output.checkWidth = Number(this.data.key.widthKey);
            this.data.output.checkHeight = Number(this.data.key.heightKey);
            if (this.data.output.checkWidth < 1700) {
                this.data.size.inputWidth.value = '1700';
                this.data.output.checkWidth = 1700;
                this.data.key.widthKey = String(this.data.output.checkWidth);

            }
            if (this.data.output.checkWidth > 2200) {
                this.data.type.notification.style.color = "#f26c4f";

            }
            if (this.data.output.checkHeight < 1500) {
                this.data.size.inputHeight.value = '1500';
                this.data.output.checkHeight = 1500;
                this.data.key.heightKey = String(this.data.output.checkHeight);
            }
            if (this.data.output.checkHeight > 1800) {
                this.data.type.notification.style.color = "#f26c4f";
            }
        }
        this.data.output.result = this[this.data.key.windowCountKey][this.data.key.windowTypeKey]
            [this.data.key.widthKey][this.data.key.heightKey];
        return this.data.output.result;
    },
    renderResult() {
        this.data.output.totalResult = Math.round(this.data.output.totalCoeff * this.data.output.result);
        this.data.output.outputValue.textContent = this.data.output.totalResult + ' руб';
        this.data.output.outputMoscowValue.textContent = Math.round(this.data.output.totalResult * 1.7) + ' руб';
        if (isNaN(this.data.output.totalResult) || this.data.output.result === undefined) {
            this.data.output.outputValue.textContent = '0 руб';
            this.data.output.outputMoscowValue.textContent = '0 руб';
        }
        if (this.data.key.windowCountKey === 'one' && this.data.output.checkWidth > 1200 ||
            this.data.key.windowCountKey === 'one' && this.data.output.checkHeight > 1500) {
            this.data.output.outputValue.textContent = '0 руб';
            this.data.output.outputMoscowValue.textContent = '0 руб';
        }
        if (this.data.key.windowCountKey === 'two' && this.data.output.checkWidth > 1600 ||
            this.data.key.windowCountKey === 'two' && this.data.output.checkHeight > 1600) {
            this.data.output.outputValue.textContent = '0 руб';
            this.data.output.outputMoscowValue.textContent = '0 руб';
        }
        if (this.data.key.windowCountKey === 'three' && this.data.output.checkWidth > 2200 ||
            this.data.key.windowCountKey === 'three' && this.data.output.checkHeight > 1800) {
            this.data.output.outputValue.textContent = '0 руб';
            this.data.output.outputMoscowValue.textContent = '0 руб';
        }
        if (this.data.output.outputValue.textContent !== '0 руб') {
            this.data.type.notification.style.color = "white";
        }

    }

};
document.addEventListener("DOMContentLoaded", ()=>{
    init();
    configPrice();
});
let coeff = document.querySelector('.brand');
let checkWindowsCount = document.querySelector('.count-windows');
coeff.addEventListener("click", (evt) => {
    let target = evt.target;
    if (target.tagName !== "BUTTON") {
        return;
    }
    totalCoeff();
});
checkWindowsCount.addEventListener('click', (evt) => {
    let target = evt.target;
    if (target.tagName !== "BUTTON") {
        return;
    }
    validPrice();
});

function init() {
    windowObject.init();
}

function totalCoeff() {
    windowObject.totalCoeff();
    if(windowObject.totalCoeff() > 0) {
        renderResult();
    }
}

function validPrice() {
    windowObject.validPrice();
    if (windowObject.validPrice() > 0) {
        renderResult();
    }
}
function  renderResult() {
    windowObject.renderResult();
}



//___Функции___//


function configPrice() {
    //___Ширина и высота___//
    windowObject.data.size.inputWidth.addEventListener('change', (e) => {
        if (typeof e.target.value !== "string") {
            return;
        }
        let eCheck = Math.round(e.target.value / 100) * 100;
        windowObject.data.key.widthKey = String(eCheck);

    });
    windowObject.data.size.inputHeight.addEventListener('change', (b) => {
            if (typeof b.target.value !== "string") {
                return;
            }
            let bCheck = Math.round(b.target.value / 100) * 100;
            if (windowObject.data.key.windowCountKey === 'one' && b.target.value >= 1000 && b.target.value <= 1099) {
                bCheck = 1000;
            }
            windowObject.data.key.heightKey = String(bCheck);
        }
    );

    //___Выбор производителя___//
    windowObject.data.brands.kbe.addEventListener('click', () => {
        windowObject.data.output.k = String(windowObject.data.brands.kbe.dataset.coeff);
    });
    windowObject.data.brands.rehau.addEventListener('click', () => {
        windowObject.data.output.k = String(windowObject.data.brands.rehau.dataset.coeff);
    });
    windowObject.data.brands.montblanc.addEventListener('click', () => {
        windowObject.data.output.k = String(windowObject.data.brands.montblanc.dataset.coeff);
    });

    //___Тип профиля___//
    windowObject.data.type.typeProfile.addEventListener('change', (e) => {
        windowObject.data.type.typeProfileValue = String(e.target.value);

    });

    //___Количество секций___//
    windowObject.data.quantity.oneWindow.addEventListener('click', () => {
        windowObject.data.key.windowCountKey = windowObject.data.quantity.oneWindow.dataset.count;
    });
    windowObject.data.quantity.twoWindows.addEventListener('click', () => {
        windowObject.data.key.windowCountKey = windowObject.data.quantity.twoWindows.dataset.count;
    });
    windowObject.data.quantity.threeWindows.addEventListener('click', () => {
        windowObject.data.key.windowCountKey = windowObject.data.quantity.threeWindows.dataset.count;
    });

    //___Тип секций___//
    windowObject.data.sectionType.oneTypeSelector.addEventListener('change', (e) => {
        windowObject.data.key.windowTypeKey1 = e.target.value;


    });
    windowObject.data.sectionType.twoTypeFirst.addEventListener('change', (e) => {
        windowObject.data.key.windowTypeKey2 = e.target.value;

        if (windowObject.data.sectionType.firstArrayOption[1].value === windowObject.data.key.windowTypeKey2) {
            windowObject.data.sectionType.secondArrayOption[1].disabled = true;
            windowObject.data.sectionType.secondArrayOption[0].selected = true;
            windowObject.data.sectionType.secondArrayOption[0].removeAttribute("disabled");
            windowObject.data.sectionType.secondArrayOption[2].removeAttribute("disabled");
            windowObject.data.sectionType.selectPowerFirst =
                windowObject.data.sectionType.firstArrayOption[1].dataset.power;

        }
        if (windowObject.data.sectionType.firstArrayOption[0].value === windowObject.data.key.windowTypeKey2) {
            windowObject.data.sectionType.selectPowerFirst =
                windowObject.data.sectionType.firstArrayOption[0].dataset.power;
            for (let i = 0; i < windowObject.data.sectionType.secondArrayOption.length; i++) {
                windowObject.data.sectionType.secondArrayOption[i].removeAttribute("disabled");
            }
            windowObject.data.sectionType.secondArrayOption[1].removeAttribute("disabled");
            windowObject.data.sectionType.secondArrayOption[2].removeAttribute("disabled");
        }
        if (windowObject.data.sectionType.firstArrayOption[2].value === windowObject.data.key.windowTypeKey2) {
            windowObject.data.sectionType.selectPowerFirst =
                windowObject.data.sectionType.firstArrayOption[2].dataset.power;
            windowObject.data.sectionType.secondArrayOption[0].disabled = true;
            windowObject.data.sectionType.secondArrayOption[1].selected = true;
            windowObject.data.sectionType.secondArrayOption[2].disabled = true;
            windowObject.data.sectionType.secondArrayOption[1].removeAttribute("disabled");
        }


    });
    windowObject.data.sectionType.twoTypeSecond.addEventListener('change', (e) => {
        windowObject.data.key.windowTypeKey3 = e.target.value;

        if (windowObject.data.sectionType.secondArrayOption[1].value === windowObject.data.key.windowTypeKey3) {
            windowObject.data.sectionType.firstArrayOption[1].disabled = true;
            windowObject.data.sectionType.firstArrayOption[0].selected = true;
            windowObject.data.sectionType.firstArrayOption[0].removeAttribute("disabled");
            windowObject.data.sectionType.firstArrayOption[2].removeAttribute("disabled");
            windowObject.data.sectionType.selectPowerSecond =
                windowObject.data.sectionType.secondArrayOption[1].dataset.power;
        }
        if (windowObject.data.sectionType.secondArrayOption[0].value === windowObject.data.keywindowTypeKey3) {
            windowObject.data.sectionType.selectPowerSecond = secondArrayOption[0].dataset.power;
            windowObject.data.sectionType.firstArrayOption[0].removeAttribute("disabled")

            for (let i = 0; i < windowObject.data.sectionType.secondArrayOption.length; i++) {
                windowObject.data.sectionType.secondArrayOption[i].removeAttribute("disabled");
            }
            windowObject.data.sectionType.firstArrayOption[1].removeAttribute("disabled");
            windowObject.data.sectionType.firstArrayOption[2].removeAttribute("disabled");
        }
        if (windowObject.data.sectionType.secondArrayOption[2].value === windowObject.data.key.windowTypeKey3) {
            windowObject.data.sectionType.firstArrayOption[0].disabled = true;
            windowObject.data.sectionType.firstArrayOption[1].selected = true;
            windowObject.data.sectionType.firstArrayOption[2].disabled = true;
            windowObject.data.sectionType.firstArrayOption[1].removeAttribute("disabled");
            windowObject.data.sectionType.selectPowerSecond =
                windowObject.data.sectionType.secondArrayOption[2].dataset.power;
        }
    });
}